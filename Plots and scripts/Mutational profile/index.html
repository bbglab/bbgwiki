
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/bbglabLOGO_small.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.2">
    
    
      
        <title>Mutational profile - BBG-Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#ffa724">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="orange" data-md-color-accent="orange">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mutational-profile" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="BBG-Wiki" class="md-header__button md-logo" aria-label="BBG-Wiki" data-md-component="logo">
      
  <img src="../../assets/images/bbglabLOGO_small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BBG-Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mutational profile
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BBG-Wiki" class="md-nav__button md-logo" aria-label="BBG-Wiki" data-md-component="logo">
      
  <img src="../../assets/images/bbglabLOGO_small.png" alt="logo">

    </a>
    BBG-Wiki
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Edit%20BBG-Wiki/" class="md-nav__link">
        Edit BBG-Wiki
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Cluster basics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cluster basics" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Cluster basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Cluster%20basics/Backups/" class="md-nav__link">
        Backups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Cluster%20basics/Headers/" class="md-nav__link">
        Headers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Cluster%20basics/Interactive/" class="md-nav__link">
        Interactive
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Cluster%20basics/Notebooks_in_cluster/" class="md-nav__link">
        Running notebooks in the cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Cluster%20basics/Screen/" class="md-nav__link">
        Screen
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Cluster%20basics/Structure/" class="md-nav__link">
        Structure
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_7" type="checkbox" id="__nav_3_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_7">
          Submitting jobs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Submitting jobs" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_7">
          <span class="md-nav__icon md-icon"></span>
          Submitting jobs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Cluster%20basics/Submitting%20jobs/Qmap/" class="md-nav__link">
        Qmap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Cluster%20basics/Submitting%20jobs/SLURM/" class="md-nav__link">
        SLURM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Datasets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Datasets" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Datasets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          General datasets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="General datasets" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          General datasets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/BeastAML/" class="md-nav__link">
        BeastAML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/CGCI/" class="md-nav__link">
        CGCI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/CPTAC/" class="md-nav__link">
        CPTAC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/GENIE/" class="md-nav__link">
        GENIE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/Hartwig/" class="md-nav__link">
        Hartwig
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/ICGC/" class="md-nav__link">
        ICGC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/PCAWG/" class="md-nav__link">
        PCAWG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/PedcBioPortal/" class="md-nav__link">
        PedcBioPortal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/StJude/" class="md-nav__link">
        StJude
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/StJudeLife/" class="md-nav__link">
        StJudeLife
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/TARGET/" class="md-nav__link">
        TARGET
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/TCGA/" class="md-nav__link">
        TCGA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/UK%20Biobank/" class="md-nav__link">
        UK Biobank
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/General%20datasets/cBioPortal/" class="md-nav__link">
        cBioPortal
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Inhouse datasets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Inhouse datasets" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Inhouse datasets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/Inhouse%20datasets/ALL%20cohort/" class="md-nav__link">
        ALL cohort
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/Inhouse%20datasets/Damage%20maps/" class="md-nav__link">
        Damage maps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/Inhouse%20datasets/Nanopore%20data/" class="md-nav__link">
        Nanopore data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/Inhouse%20datasets/Pediatric%20Rhabdoid%20cohort/" class="md-nav__link">
        Pediatric Rhabdoid cohort
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/Inhouse%20datasets/Pediatric%20Secondary%20neoplasms/" class="md-nav__link">
        Pediatric Secondary neoplasms
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          Other data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other data" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Other data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/Other%20data/Canonical%20transcripts/" class="md-nav__link">
        Canonical transcripts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/Other%20data/Genomic%20regions/" class="md-nav__link">
        Genomic regions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/Other%20data/Nmdetective/" class="md-nav__link">
        Nmdetective
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Datasets/Other%20data/Reference%20genomes/" class="md-nav__link">
        Reference genomes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Plots and scripts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Plots and scripts" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Plots and scripts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Intogen-BoostDM%20plots/" class="md-nav__link">
        Intogen-BoostDM plots
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Mutational profile
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Mutational profile
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function" class="md-nav__link">
    Function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#normalization-of-the-vector" class="md-nav__link">
    Normalization of the vector
  </a>
  
    <nav class="md-nav" aria-label="Normalization of the vector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#needed-functions" class="md-nav__link">
    Needed functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#normalization" class="md-nav__link">
    Normalization
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    Reference
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Needle%20plot/" class="md-nav__link">
        Needle plot
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tools" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Nextflow/" class="md-nav__link">
        Nextflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          BBG tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="BBG tools" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          BBG tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/BBG-tools/BGconfig/" class="md-nav__link">
        BGconfig
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/BBG-tools/BGdata/" class="md-nav__link">
        BGdata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/BBG-tools/BGlogs/" class="md-nav__link">
        BGlogs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/BBG-tools/BGpack/" class="md-nav__link">
        BGpack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/BBG-tools/BGreference/" class="md-nav__link">
        BGreference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/BBG-tools/BGsignature/" class="md-nav__link">
        BGsignature
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/BBG-tools/BGvep/" class="md-nav__link">
        BGvep
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/BBG-tools/OpenVariant/" class="md-nav__link">
        OpenVariant
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_4" type="checkbox" id="__nav_6_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_4">
          Sequencing tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Sequencing tools" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_4">
          <span class="md-nav__icon md-icon"></span>
          Sequencing tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Sequencing%20tools/Bedtools/" class="md-nav__link">
        Bedtools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Sequencing%20tools/Bowtie2/" class="md-nav__link">
        Bowtie2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Sequencing%20tools/Cutadapt/" class="md-nav__link">
        Cutadapt
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Sequencing%20tools/Fastqc/" class="md-nav__link">
        Fastqc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Sequencing%20tools/Samtools/" class="md-nav__link">
        SAMtools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Sequencing%20tools/Trimmomatic/" class="md-nav__link">
        Trimmomatic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Sequencing%20tools/Vep/" class="md-nav__link">
        Vep
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Sequencing%20tools/pysam/" class="md-nav__link">
        pysam
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_4_9" type="checkbox" id="__nav_6_4_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_4_9">
          Variant callers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Variant callers" data-md-level="3">
        <label class="md-nav__title" for="__nav_6_4_9">
          <span class="md-nav__icon md-icon"></span>
          Variant callers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Sequencing%20tools/Variant%20callers/MosaicForecast/" class="md-nav__link">
        MosaicForecast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Sequencing%20tools/Variant%20callers/Mutect2/" class="md-nav__link">
        Mutect2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Sequencing%20tools/Variant%20callers/Platinum/" class="md-nav__link">
        Platinum
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Sequencing%20tools/Variant%20callers/Sarek/" class="md-nav__link">
        Sarek
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_5" type="checkbox" id="__nav_6_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_5">
          Signature tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Signature tools" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_5">
          <span class="md-nav__icon md-icon"></span>
          Signature tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Signature%20tools/DeconstructSigs/" class="md-nav__link">
        DeconstructSigs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Signature%20tools/SigProfiler/" class="md-nav__link">
        SigProfiler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Signature%20tools/SigProfilerJulia/" class="md-nav__link">
        SigProfilerJulia
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Signature%20tools/mSigHDP/" class="md-nav__link">
        mSigHDP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Signature%20tools/mSignAct/" class="md-nav__link">
        mSignAct
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_6" type="checkbox" id="__nav_6_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_6">
          Singularity
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Singularity" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_6">
          <span class="md-nav__icon md-icon"></span>
          Singularity
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Singularity/Building%20containers/" class="md-nav__link">
        Building containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Singularity/Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Singularity/Using%20containers/" class="md-nav__link">
        Using containers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function" class="md-nav__link">
    Function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#normalization-of-the-vector" class="md-nav__link">
    Normalization of the vector
  </a>
  
    <nav class="md-nav" aria-label="Normalization of the vector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#needed-functions" class="md-nav__link">
    Needed functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#normalization" class="md-nav__link">
    Normalization
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    Reference
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="mutational-profile">Mutational profile<a class="headerlink" href="#mutational-profile" title="Permanent link">&para;</a></h1>
<p>The function <code>plot_signature</code>  will allow you to plot the mutational profile of a sample given the vector of 96 channels (see y axis in the example figure) with the frequencies of each nucleotide change. 
It takes as input the the vector with the mutations frequency  (<code>profile</code>) and the title of the plot (<code>title</code>).</p>
<p>The function <code>minor_tick_labels</code>  is needed to generate the labels of the plot.</p>
<h3 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h3>
<p><img alt="Plot mutational profile" src="../../assets/images/plot_mutational_profile.png" /></p>
<h3 id="function">Function<a class="headerlink" href="#function" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>import seaborn as sns
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>import numpy as np
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>def minor_tick_labels<span class="o">()</span>:
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="nv">major_labels</span> <span class="o">=</span> <span class="o">[</span><span class="s1">&#39;C&gt;A&#39;</span>, <span class="s1">&#39;C&gt;G&#39;</span>, <span class="s1">&#39;C&gt;T&#39;</span>, <span class="s1">&#39;T&gt;A&#39;</span>, <span class="s1">&#39;T&gt;C&#39;</span>, <span class="s1">&#39;T&gt;G&#39;</span><span class="o">]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="nv">flanks</span> <span class="o">=</span> <span class="o">[</span><span class="s1">&#39;AA&#39;</span>, <span class="s1">&#39;AC&#39;</span>, <span class="s1">&#39;AG&#39;</span>, <span class="s1">&#39;AT&#39;</span>, <span class="s1">&#39;CA&#39;</span>, <span class="s1">&#39;CC&#39;</span>, <span class="s1">&#39;CG&#39;</span>, <span class="s1">&#39;CT&#39;</span>,
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>              <span class="s1">&#39;GA&#39;</span>, <span class="s1">&#39;GC&#39;</span>, <span class="s1">&#39;GG&#39;</span>, <span class="s1">&#39;GT&#39;</span>, <span class="s1">&#39;TA&#39;</span>, <span class="s1">&#39;TC&#39;</span>, <span class="s1">&#39;TG&#39;</span>, <span class="s1">&#39;TT&#39;</span><span class="o">]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="nv">minor_labels</span> <span class="o">=</span> <span class="o">[]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="k">for</span> subs <span class="k">in</span> major_labels:
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        <span class="k">for</span> flank <span class="k">in</span> flanks:
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>            minor_labels.append<span class="o">(</span>flank<span class="o">[</span><span class="m">0</span><span class="o">]</span> + subs<span class="o">[</span><span class="m">0</span><span class="o">]</span> + flank<span class="o">[</span><span class="m">1</span><span class="o">])</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="k">return</span> minor_labels
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>def plot_signature<span class="o">(</span>profile, <span class="nv">title</span><span class="o">=</span>None<span class="o">)</span>:
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="s2">    Args:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="s2">        profile: 96-array in lexicographic order</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="s2">        title: string</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="s2">    Returns:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="s2">        produces the signature bar plot</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="s2">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    fig, <span class="nv">ax</span> <span class="o">=</span> plt.subplots<span class="o">(</span><span class="nv">figsize</span><span class="o">=(</span><span class="m">15</span>, <span class="m">2</span><span class="o">))</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>    <span class="nv">total</span> <span class="o">=</span> np.sum<span class="o">(</span>profile<span class="o">)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="k">if</span> abs<span class="o">(</span>total - <span class="m">1</span><span class="o">)</span> &gt; <span class="m">0</span>.01:
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="nv">profile</span> <span class="o">=</span> profile / total
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    sns.set<span class="o">(</span><span class="nv">font_scale</span><span class="o">=</span><span class="m">1</span>.5<span class="o">)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    sns.set_style<span class="o">(</span><span class="s1">&#39;white&#39;</span><span class="o">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>    <span class="c1"># bar plot</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    <span class="nv">barlist</span> <span class="o">=</span> ax.bar<span class="o">(</span>range<span class="o">(</span><span class="m">96</span><span class="o">)</span>, profile<span class="o">)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>    <span class="nv">color_list</span> <span class="o">=</span> <span class="o">[</span><span class="s1">&#39;#72bcd4&#39;</span>, <span class="s1">&#39;k&#39;</span>, <span class="s1">&#39;r&#39;</span>, <span class="s1">&#39;#7e7e7e&#39;</span>, <span class="s1">&#39;g&#39;</span>, <span class="s1">&#39;#e6add8&#39;</span><span class="o">]</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    <span class="k">for</span> category <span class="k">in</span> range<span class="o">(</span><span class="m">6</span><span class="o">)</span>:
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>        <span class="k">for</span> i <span class="k">in</span> range<span class="o">(</span><span class="m">16</span><span class="o">)</span>:
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>            barlist<span class="o">[</span>category * <span class="m">16</span> + i<span class="o">]</span>.set_color<span class="o">(</span>color_list<span class="o">[</span>category<span class="o">])</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>    ax.set_xlim<span class="o">([</span>-0.5, <span class="m">96</span><span class="o">])</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>    <span class="nv">ymax</span> <span class="o">=</span> np.max<span class="o">(</span>profile<span class="o">)</span> * <span class="m">1</span>.2
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>    ax.set_ylim<span class="o">(</span><span class="m">0</span>, ymax<span class="o">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>    <span class="c1"># ax.set_ylabel(&#39;subs rel freq&#39;)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>    <span class="nv">labels</span> <span class="o">=</span> <span class="o">[</span><span class="s1">&#39;C&gt;A&#39;</span>, <span class="s1">&#39;C&gt;G&#39;</span>, <span class="s1">&#39;C&gt;T&#39;</span>, <span class="s1">&#39;T&gt;A&#39;</span>, <span class="s1">&#39;T&gt;C&#39;</span>, <span class="s1">&#39;T&gt;G&#39;</span><span class="o">]</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>    <span class="nv">major_ticks</span> <span class="o">=</span> np.arange<span class="o">(</span><span class="m">8</span>, <span class="m">8</span> + <span class="m">16</span> * <span class="m">5</span> + <span class="m">1</span>, <span class="m">16</span><span class="o">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>    <span class="nv">minor_ticks</span> <span class="o">=</span> np.arange<span class="o">(</span><span class="m">0</span>.2, <span class="m">96</span>.2, <span class="m">1</span><span class="o">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>    ax.tick_params<span class="o">(</span><span class="nv">length</span><span class="o">=</span><span class="m">0</span>, <span class="nv">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span>, <span class="nv">pad</span><span class="o">=</span><span class="m">30</span>, <span class="nv">labelsize</span><span class="o">=</span><span class="m">12</span><span class="o">)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>    ax.tick_params<span class="o">(</span><span class="nv">length</span><span class="o">=</span><span class="m">0</span>, <span class="nv">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span>, <span class="nv">pad</span><span class="o">=</span><span class="m">5</span>, <span class="nv">labelsize</span><span class="o">=</span><span class="m">10</span><span class="o">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>    ax.set_xticks<span class="o">(</span>major_ticks, <span class="nv">minor</span><span class="o">=</span>False<span class="o">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>    ax.set_xticklabels<span class="o">(</span>labels, <span class="nv">minor</span><span class="o">=</span>False<span class="o">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>    ax.set_xticks<span class="o">(</span>minor_ticks, <span class="nv">minor</span><span class="o">=</span>True<span class="o">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>    ax.set_xticklabels<span class="o">(</span>minor_tick_labels<span class="o">()</span>, <span class="nv">minor</span><span class="o">=</span>True, <span class="nv">rotation</span><span class="o">=</span><span class="m">90</span><span class="o">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>    ax.spines<span class="o">[</span><span class="s1">&#39;top&#39;</span><span class="o">]</span>.set_visible<span class="o">(</span>False<span class="o">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>    ax.spines<span class="o">[</span><span class="s1">&#39;bottom&#39;</span><span class="o">]</span>.set_visible<span class="o">(</span>False<span class="o">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>    ax.spines<span class="o">[</span><span class="s1">&#39;left&#39;</span><span class="o">]</span>.set_visible<span class="o">(</span>False<span class="o">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>    ax.spines<span class="o">[</span><span class="s1">&#39;right&#39;</span><span class="o">]</span>.set_visible<span class="o">(</span>False<span class="o">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>    ax.set_title<span class="o">(</span>title, <span class="nv">fontsize</span><span class="o">=</span><span class="m">24</span><span class="o">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>    plt.show<span class="o">()</span>
</code></pre></div>
<div class="admonition note annotate">
<p>Note: </p>
<ul>
<li>The function normalizes the vector so that the sum of all the frequencies is equal to 1.</li>
<li>If you want to normalize the frequencies so that the trinucleotide composition of the genomic regions from which the mutations have been obtained, you need to normalize the vector taking into account the trinucleotide composition before using the function plot_signature.</li>
</ul>
</div>
<h3 id="normalization-of-the-vector">Normalization of the vector<a class="headerlink" href="#normalization-of-the-vector" title="Permanent link">&para;</a></h3>
<p>In order to normalize the vector you will need to import from <a href="https://bbglab.github.io/bbgwiki/Tools/BBG-tools/BGreference/" target="_blank">bgreference</a> the reference genome in which the data has been sequenced.</p>
<p>You will also need the vector with the mutations frequency (<code>profile</code>) and the directory of a file with the genomic regions from which the mutations have been obtained (<code>regions_file_dir</code>), with at least the columns: <code>CHROMOSOME</code>, <code>START</code>, <code>END</code>.</p>
<h4 id="needed-functions">Needed functions<a class="headerlink" href="#needed-functions" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>from itertools import product
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>import pandas as pd
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>import numpy as np
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="nv">cb</span> <span class="o">=</span> dict<span class="o">(</span>zip<span class="o">(</span><span class="s1">&#39;ACGT&#39;</span>,<span class="s1">&#39;TGCA&#39;</span><span class="o">))</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>def triplet_index<span class="o">(</span>triplet<span class="o">)</span>:
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    a, ref, <span class="nv">b</span> <span class="o">=</span> tuple<span class="o">(</span>list<span class="o">(</span>triplet<span class="o">))</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    <span class="nv">s</span> <span class="o">=</span> <span class="m">16</span> * <span class="o">(</span><span class="nv">ref</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="o">)</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>    <span class="nv">t</span> <span class="o">=</span> <span class="m">4</span> * <span class="o">((</span><span class="nv">a</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="o">)</span> + <span class="m">2</span> * <span class="o">(</span><span class="nv">a</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="o">)</span> + <span class="m">3</span> * <span class="o">(</span><span class="nv">a</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="o">))</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    <span class="nv">u</span> <span class="o">=</span> <span class="o">(</span><span class="nv">b</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="o">)</span> + <span class="m">2</span> * <span class="o">(</span><span class="nv">b</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="o">)</span> + <span class="m">3</span> * <span class="o">(</span><span class="nv">b</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="o">)</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    <span class="k">return</span> s + t + u
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>def sbs_format<span class="o">(</span>triplet_count<span class="o">)</span>:
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>    <span class="s2">&quot;&quot;&quot;Maps ref triplets to 96 SBS channel&quot;&quot;&quot;</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>    <span class="nv">vector</span> <span class="o">=</span> <span class="o">[]</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>    <span class="k">for</span> ref <span class="k">in</span> <span class="s1">&#39;CT&#39;</span>:
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>        <span class="k">for</span> alt <span class="k">in</span> <span class="s1">&#39;ACGT&#39;</span>:
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>            <span class="k">if</span> alt !<span class="o">=</span> ref:
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>                <span class="k">for</span> a, b <span class="k">in</span> product<span class="o">(</span>cb, <span class="nv">repeat</span><span class="o">=</span><span class="m">2</span><span class="o">)</span>:
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>                    vector.append<span class="o">(</span>triplet_count<span class="o">[</span>triplet_index<span class="o">(</span>a + ref + b<span class="o">)])</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>    <span class="k">return</span> vector
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>def triplets<span class="o">()</span>:
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>    <span class="k">for</span> ref <span class="k">in</span> <span class="s1">&#39;CT&#39;</span>:
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>        <span class="k">for</span> a, b <span class="k">in</span> product<span class="o">(</span>cb, <span class="nv">repeat</span><span class="o">=</span><span class="m">2</span><span class="o">)</span>:
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>            yield a + ref + b
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>def count_triplets<span class="o">(</span>seq<span class="o">)</span>:
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>    <span class="k">return</span> <span class="o">[</span>seq.count<span class="o">(</span>t<span class="o">)</span> + seq.count<span class="o">(</span>rev<span class="o">(</span>t<span class="o">))</span> <span class="k">for</span> t <span class="k">in</span> triplets<span class="o">()]</span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>def rev<span class="o">(</span>seq<span class="o">)</span>:
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>    <span class="s2">&quot;&quot;&quot;reverse complement of seq&quot;&quot;&quot;</span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>    <span class="k">return</span> <span class="s1">&#39;&#39;</span>.join<span class="o">(</span>list<span class="o">(</span>map<span class="o">(</span>lambda s: cb<span class="o">[</span>s<span class="o">]</span>, seq<span class="o">[</span>::-1<span class="o">])))</span> 
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a>def get_triplet_counts_region<span class="o">(</span>regions_file_dir,reference_genome<span class="o">=</span>hg38<span class="o">)</span>:
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>    <span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a><span class="s2">    Function to obtain the vector with 96 triplet counts given the regions file.</span>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a><span class="s2">    &quot;&quot;&quot;</span>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a>    <span class="nv">regions</span><span class="o">=</span>pd.read_csv<span class="o">(</span>regions_file_dir,sep<span class="o">=</span><span class="s1">&#39;\t&#39;</span>,dtype<span class="o">={</span><span class="s1">&#39;CHROMOSOME&#39;</span>:<span class="s1">&#39;string&#39;</span><span class="o">})</span>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a>    assert<span class="o">(</span>np.all<span class="o">(</span>regions.apply<span class="o">(</span>lambda r: r<span class="o">[</span><span class="s1">&#39;END&#39;</span><span class="o">]</span> - r<span class="o">[</span><span class="s1">&#39;START&#39;</span><span class="o">]</span> + <span class="m">1</span> &gt; <span class="m">0</span>, <span class="nv">axis</span><span class="o">=</span><span class="m">1</span><span class="o">)))</span>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a>    regions<span class="o">[</span><span class="s1">&#39;interval&#39;</span><span class="o">]</span> <span class="o">=</span> regions.apply<span class="o">(</span>lambda r: <span class="o">(</span>r<span class="o">[</span><span class="s1">&#39;CHROMOSOME&#39;</span><span class="o">]</span>, r<span class="o">[</span><span class="s1">&#39;START&#39;</span><span class="o">]</span>, r<span class="o">[</span><span class="s1">&#39;END&#39;</span><span class="o">])</span>, <span class="nv">axis</span><span class="o">=</span><span class="m">1</span><span class="o">)</span>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a>    <span class="nv">counts</span> <span class="o">=</span> np.zeros<span class="o">(</span><span class="m">32</span><span class="o">)</span>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a>    <span class="k">for</span> chrom, start, end <span class="k">in</span> list<span class="o">(</span>regions<span class="o">[</span><span class="s1">&#39;interval&#39;</span><span class="o">])</span>:
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a>        try:
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a>            <span class="nv">seq</span> <span class="o">=</span> reference_genome<span class="o">(</span>chrom, start-1, <span class="nv">size</span><span class="o">=</span>end-start+3<span class="o">)</span>  <span class="c1"># sequence +1 nt 5&#39; and 3&#39; flanking nucleotides</span>
<a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a>            <span class="nv">c</span> <span class="o">=</span> np.array<span class="o">(</span>count_triplets<span class="o">(</span>seq<span class="o">))</span>
<a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a>            <span class="nv">counts</span> <span class="o">+=</span> c
<a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a>        except Exception as e:
<a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a>            print<span class="o">(</span>e<span class="o">)</span>
<a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a>    <span class="k">return</span> sbs_format<span class="o">(</span>list<span class="o">(</span>map<span class="o">(</span>int, counts<span class="o">)))</span>
</code></pre></div>
<h4 id="normalization">Normalization<a class="headerlink" href="#normalization" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nv">region_triplet_abundance</span><span class="o">=</span>get_triplet_counts_region<span class="o">(</span>regions_file_dir<span class="o">)</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nv">normalized_profile</span> <span class="o">=</span> np.array<span class="o">(</span>profile<span class="o">)</span>/np.array<span class="o">(</span>region_triplet_abundance<span class="o">)</span>
</code></pre></div>
<h2 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link">&para;</a></h2>
<ul>
<li>Paula Gomis</li>
<li>Ferran Muios</li>
</ul>




              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../Intogen-BoostDM%20plots/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Intogen-BoostDM plots" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Intogen-BoostDM plots
            </div>
          </div>
        </a>
      
      
        
        <a href="../Needle%20plot/" class="md-footer__link md-footer__link--next" aria-label="Next: Needle plot" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Needle plot
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.top", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
    
  </body>
</html>